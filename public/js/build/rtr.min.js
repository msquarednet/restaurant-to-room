"use strict";angular.module("app",["ngRoute","ngDialog"]).config(["$routeProvider",function(t){t.otherwise({redirectTo:"/restaurants"})}]),function(){function t(t){t.when("/restaurants",{templateUrl:"/js/app/restaurants/restaurants.html",controller:"RestaurantsController",controllerAs:"vm"}).when("/menu/:restId",{templateUrl:"/js/app/menu/menu.html",controller:"MenuController",controllerAs:"vm"}).when("/payment",{templateUrl:"/js/app/payment/payment.html",controller:"PaymentController",controllerAs:"vm"}).when("/confirmation",{templateUrl:"/js/app/confirmation/confirmation.html"})}angular.module("app").config(t),t.$inject=["$routeProvider"]}(),function(){function t(){return{require:"ngModel",link:function(t,e,n,r){r.$validators.creditCard=function(t,e){if(!e)return!0;if(/[^0-9-\s]+/.test(e))return!1;var n=0,r=0,a=!1;e=e.replace(/\D/g,"");for(var o=e.length-1;o>=0;o--){var i=e.charAt(o),r=parseInt(i,10);a&&(r*=2)>9&&(r-=9),n+=r,a=!a}return n%10==0}}}}angular.module("app").directive("creditCard",t)}(),function(){function t(t,e){var n=this;n.submit=function(){n.showProgress=!0,t.placeOrder(n.card).then(function(t){return t&&t.success?e.url("/confirmation"):void alert("Something went wrong when placing order (api.placeOrder)")})}}angular.module("app").controller("PaymentController",t),t.$inject=["api","$location"]}(),function(){function t(t){var e=this;t.getRestaurants().then(function(t){e.restaurants=t})}angular.module("app").controller("RestaurantsController",t),t.$inject=["api"]}(),function(){function t(t){function e(){return t.get("/orders/api/restaurants").then(function(t){return t.data})}function n(e){return t.get("/orders/api/restaurant-details/"+e).then(function(t){return t.data})}function r(e){return t.post("/orders/api/create-order",e).then(function(t){return t.data})}function a(e){return t.post("/orders/api/place-order",e).then(function(t){return t.data})}return{getRestaurants:e,getRestaurantDetails:n,createOrder:r,placeOrder:a}}angular.module("app").factory("api",t),t.$inject=["$http"]}(),function(){function t(t,e,n,r,a){var o=this;o.items=[],t.getRestaurantDetails(e.restId).then(function(t){o.restaurant=t}),o.viewItem=function(t){o.activeItem=t,o.activeItem.options=[],n.open({template:"item.html",className:"ngdialog-theme-default",scope:r})},o.toggleOption=function(t){var e=o.activeItem.options.indexOf(t);e>-1?o.activeItem.options.splice(e,1):o.activeItem.options.push(t)},o.addItem=function(t){var e={id:t.id,name:t.name,price:t.price};t.options.length>0&&(e.options=t.options.map(function(t){return{id:t.id,name:t.name,price:t.price}})),o.items.push(e),n.close(),console.log(o.items)},o.cancel=function(){n.close()},o.checkout=function(){var n={restId:e.restId,restName:o.restaurant.name,items:o.items};t.createOrder(n).then(function(t){t.success?a.url("/payment"):alert("Order NOT created! Uh-oh.")})}}angular.module("app").controller("MenuController",t),t.$inject=["api","$routeParams","ngDialog","$scope","$location"]}();